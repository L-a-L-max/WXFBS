# ğŸ“ ä»£ç è§„èŒƒ

æœ¬æ–‡æ¡£å®šä¹‰äº†å¾®ä¿¡ç¦å¸®æ‰‹é¡¹ç›®çš„ä»£ç è§„èŒƒï¼ŒåŸºäºè‹¥ä¾æ¡†æ¶çš„æœ€ä½³å®è·µã€‚

---

## ğŸ“‹ ç›®å½•
- [Java åç«¯è§„èŒƒ](#-java-åç«¯è§„èŒƒ)
- [Vue å‰ç«¯è§„èŒƒ](#-vue-å‰ç«¯è§„èŒƒ)
- [æ•°æ®åº“è§„èŒƒ](#-æ•°æ®åº“è§„èŒƒ)

---

## â˜• Java åç«¯è§„èŒƒ

### 1. å‘½åè§„èŒƒ

#### ç±»å
```java
// âœ… æ­£ç¡®ï¼šå¤§é©¼å³°ï¼ˆPascalCaseï¼‰
public class DailyArticleController { }
public class YuanqiAgentApiService { }
```

#### æ–¹æ³•åå’Œå˜é‡å
```java
// âœ… æ­£ç¡®ï¼šå°é©¼å³°ï¼ˆcamelCaseï¼‰
private String articleTitle;
public void createArticle() { }
```

#### å¸¸é‡å
```java
// âœ… æ­£ç¡®ï¼šå…¨å¤§å†™ï¼Œä¸‹åˆ’çº¿åˆ†éš”
public static final String API_URL = "https://api.example.com";
public static final int MAX_RETRY_COUNT = 3;
```

### 2. æ³¨é‡Šè§„èŒƒ

**é‡è¦**ï¼šæ‰€æœ‰ä¸šåŠ¡ä»£ç å¿…é¡»åŒ…å«å¿…è¦çš„æ³¨é‡Šï¼Œè¯´æ˜ä¸šåŠ¡é€»è¾‘å’Œå…³é”®å¤„ç†æµç¨‹ã€‚

#### ç±»æ³¨é‡Šï¼ˆå¿…éœ€ï¼‰
```java
/**
 * æ—¥æ›´åŠ©æ‰‹æ–‡ç« æ§åˆ¶å™¨
 * 
 * æä¾›æ–‡ç« çš„åˆ›å»ºã€æŸ¥è¯¢ã€åˆ é™¤ç­‰åŠŸèƒ½
 * æ”¯æŒAIä¼˜åŒ–å’Œæ™ºèƒ½æ’ç‰ˆ
 *
 * @author wxfbsir
 * @date 2025-12-05
 */
@RestController
@RequestMapping("/system/daily-article")
public class DailyArticleController extends BaseController {
    // ...
}
```

#### æ–¹æ³•æ³¨é‡Šï¼ˆå¿…éœ€ï¼‰
```java
/**
 * åˆ›å»ºæ–‡ç« å¹¶è°ƒç”¨AIä¼˜åŒ–
 * 
 * æ­¤æ–¹æ³•ä¼šå¼‚æ­¥è°ƒç”¨è…¾è®¯å…ƒå™¨æ™ºèƒ½ä½“ï¼Œä¸ç­‰å¾…å†…å®¹ç”Ÿæˆå®Œæˆã€‚
 * å‰ç«¯éœ€è¦é€šè¿‡è½®è¯¢æ¥å£æŸ¥è¯¢å¤„ç†çŠ¶æ€ã€‚
 *
 * @param params è¯·æ±‚å‚æ•°ï¼ŒåŒ…å« articleTitle å’Œ selectedModels
 * @return æ–‡ç« åŸºæœ¬ä¿¡æ¯å’Œå¤„ç†çŠ¶æ€
 */
@PostMapping("/createAndOptimize")
public AjaxResult createAndOptimize(@RequestBody Map<String, String> params) {
    // ...
}
```

#### å¤æ‚é€»è¾‘æ³¨é‡Šï¼ˆå¿…éœ€ï¼‰
```java
// ç‰¹æ®Šå¤„ç†504 Gateway Timeoutï¼šä»»åŠ¡å¯èƒ½å·²æäº¤æˆåŠŸï¼Œåªæ˜¯ç½‘å…³ç­‰ä¸åŠè¿”å›ç»“æœ
if (errorMsg != null && errorMsg.contains("504 Gateway Time-out")) {
    log.warn("æ”¶åˆ°504 Gateway Timeoutï¼Œä»»åŠ¡å¯èƒ½å·²æäº¤æˆåŠŸ");
    // è¿”å›æˆåŠŸçŠ¶æ€ï¼Œè®©ç³»ç»Ÿç­‰å¾…å›è°ƒ
    return YuanqiApiResponse.success("", "pending-" + articleId);
}
```

### 3. ä»£ç ç»“æ„ä¸æ¨¡å—åˆ’åˆ†

**é‡è¦è§„èŒƒ**ï¼š
- âœ… ä¸šåŠ¡é€»è¾‘ä»£ç é»˜è®¤æ”¾åœ¨ `WxFbsir-business` æ¨¡å—ä¸‹
- âœ… å‰ç«¯ä¸šåŠ¡é¡µé¢é»˜è®¤æ”¾åœ¨ `WxFbsir-ui/src/views/business` ç›®å½•ä¸‹
- âš ï¸ å¦‚éœ€åœ¨å…¶ä»–ä½ç½®å­˜æ”¾ä¸šåŠ¡ä»£ç ï¼Œå¿…é¡»å…ˆä¸ç®¡ç†å‘˜æ¢è®¨ç¡®è®¤åæ‰å¯ä»¥

#### Controller å±‚ï¼ˆæ”¾åœ¨ WxFbsir-business æ¨¡å—ï¼‰
```java
@RestController
@RequestMapping("/system/daily-article")
public class DailyArticleController extends BaseController {
    
    @Autowired
    private IDailyArticleService dailyArticleService;
    
    /**
     * æŸ¥è¯¢åˆ—è¡¨
     */
    @GetMapping("/list")
    public TableDataInfo list(DailyArticle dailyArticle) {
        startPage();
        List<DailyArticle> list = dailyArticleService.selectDailyArticleList(dailyArticle);
        return getDataTable(list);
    }
    
    /**
     * æ–°å¢
     */
    @PostMapping
    public AjaxResult add(@Validated @RequestBody DailyArticle dailyArticle) {
        return toAjax(dailyArticleService.insertDailyArticle(dailyArticle));
    }
}
```

#### Service å±‚ï¼ˆæ”¾åœ¨ WxFbsir-business æ¨¡å—ï¼‰
```java
@Service
public class DailyArticleServiceImpl implements IDailyArticleService {
    
    @Autowired
    private DailyArticleMapper dailyArticleMapper;
    
    @Override
    public List<DailyArticle> selectDailyArticleList(DailyArticle dailyArticle) {
        return dailyArticleMapper.selectDailyArticleList(dailyArticle);
    }
    
    @Override
    @Transactional(rollbackFor = Exception.class)
    public int insertDailyArticle(DailyArticle dailyArticle) {
        dailyArticle.setCreateTime(DateUtils.getNowDate());
        return dailyArticleMapper.insertDailyArticle(dailyArticle);
    }
}
```

### 4. å¼‚å¸¸å¤„ç†

```java
// âœ… æ­£ç¡®ï¼šæ•è·å…·ä½“å¼‚å¸¸ï¼Œè®°å½•æ—¥å¿—
try {
    dailyArticleService.createArticle(articleTitle);
} catch (IllegalArgumentException e) {
    log.error("å‚æ•°é”™è¯¯: {}", e.getMessage());
    return error("å‚æ•°é”™è¯¯: " + e.getMessage());
} catch (Exception e) {
    log.error("åˆ›å»ºæ–‡ç« å¤±è´¥", e);
    return error("åˆ›å»ºå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");
}

// âŒ é”™è¯¯ï¼šæ•è·æ‰€æœ‰å¼‚å¸¸ï¼Œä¸è®°å½•æ—¥å¿—
try {
    dailyArticleService.createArticle(articleTitle);
} catch (Exception e) {
    return error("å¤±è´¥");
}
```

### 5. æ—¥å¿—è§„èŒƒ

```java
// âœ… æ­£ç¡®ï¼šä½¿ç”¨å ä½ç¬¦ï¼Œé¿å…å­—ç¬¦ä¸²æ‹¼æ¥
log.info("åˆ›å»ºæ–‡ç« æˆåŠŸ - articleId: {}, userId: {}", articleId, userId);
log.error("è°ƒç”¨APIå¤±è´¥ - url: {}, error: {}", apiUrl, e.getMessage(), e);

// âŒ é”™è¯¯ï¼šå­—ç¬¦ä¸²æ‹¼æ¥
log.info("åˆ›å»ºæ–‡ç« æˆåŠŸ - articleId: " + articleId + ", userId: " + userId);
```

### 6. äº‹åŠ¡ç®¡ç†

```java
// âœ… æ­£ç¡®ï¼šæŒ‡å®šå›æ»šå¼‚å¸¸
@Transactional(rollbackFor = Exception.class)
public int updateArticle(DailyArticle article) {
    // æ›´æ–°æ–‡ç« 
    dailyArticleMapper.updateDailyArticle(article);
    // æ›´æ–°ç»Ÿè®¡
    statisticsMapper.updateCount(article.getUserId());
    return 1;
}

// âŒ é”™è¯¯ï¼šä¸æŒ‡å®šå›æ»šå¼‚å¸¸ï¼ˆé»˜è®¤åªå›æ»š RuntimeExceptionï¼‰
@Transactional
public int updateArticle(DailyArticle article) {
    // ...
}
```

---

## ğŸ¨ Vue å‰ç«¯è§„èŒƒ

### 1. ç»„ä»¶å‘½å

```vue
<!-- âœ… æ­£ç¡®ï¼šå¤§é©¼å³°ï¼Œå¤šä¸ªå•è¯ -->
<template>
  <DailyArticleList />
  <YuanqiConfigDialog />
</template>

<!-- âŒ é”™è¯¯ï¼šå•ä¸ªå•è¯æˆ–å°å†™ -->
<template>
  <article />
  <config-dialog />
</template>
```

### 2. å˜é‡å‘½å

```javascript
// âœ… æ­£ç¡®ï¼šå°é©¼å³°
const articleTitle = ref('')
const selectedModels = ref([])
const isLoading = ref(false)

// âŒ é”™è¯¯ï¼šä¸‹åˆ’çº¿æˆ–å¤§é©¼å³°
const article_title = ref('')
const ArticleTitle = ref('')
```

### 3. Props å®šä¹‰

```vue
<script setup>
// âœ… æ­£ç¡®ï¼šå®šä¹‰ç±»å‹ã€é»˜è®¤å€¼ã€å¿…å¡«é¡¹
const props = defineProps({
  articleId: {
    type: Number,
    required: true
  },
  title: {
    type: String,
    default: ''
  },
  status: {
    type: Number,
    default: 0,
    validator: (value) => [0, 1, 2].includes(value)
  }
})

// âŒ é”™è¯¯ï¼šä¸å®šä¹‰ç±»å‹
const props = defineProps(['articleId', 'title', 'status'])
</script>
```

### 4. äº‹ä»¶å‘½å

```vue
<template>
  <!-- âœ… æ­£ç¡®ï¼škebab-case -->
  <el-button @click="handleCreate">åˆ›å»º</el-button>
  <ArticleItem @article-selected="handleSelect" />
  
  <!-- âŒ é”™è¯¯ï¼šcamelCase -->
  <el-button @click="handleCreate">åˆ›å»º</el-button>
  <ArticleItem @articleSelected="handleSelect" />
</template>
```

### 5. ç»„ä»¶ç»“æ„

```vue
<template>
  <!-- æ¨¡æ¿å†…å®¹ -->
</template>

<script setup>
// 1. å¯¼å…¥
import { ref, onMounted } from 'vue'
import { ElMessage } from 'element-plus'
import { getArticleList } from '@/api/business/dailyArticle'

// 2. Props å’Œ Emits
const props = defineProps({ /* ... */ })
const emit = defineEmits(['update', 'delete'])

// 3. å“åº”å¼æ•°æ®
const articles = ref([])
const loading = ref(false)

// 4. è®¡ç®—å±æ€§
const filteredArticles = computed(() => {
  return articles.value.filter(item => item.status === 1)
})

// 5. æ–¹æ³•
function handleCreate() {
  // ...
}

// 6. ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  loadArticles()
})
</script>

<style scoped>
/* æ ·å¼ */
</style>
```

### 6. API è°ƒç”¨

```javascript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ async/awaitï¼Œå¤„ç†é”™è¯¯
async function loadArticles() {
  loading.value = true
  try {
    const response = await getArticleList()
    articles.value = response.rows
  } catch (error) {
    ElMessage.error('åŠ è½½å¤±è´¥ï¼š' + error.message)
  } finally {
    loading.value = false
  }
}

// âŒ é”™è¯¯ï¼šä¸å¤„ç†é”™è¯¯
function loadArticles() {
  getArticleList().then(response => {
    articles.value = response.rows
  })
}
```

### 7. ç¯å¢ƒå˜é‡

```javascript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ Vite ç¯å¢ƒå˜é‡
const baseURL = import.meta.env.VITE_APP_BASE_API
const isDev = import.meta.env.DEV

// âŒ é”™è¯¯ï¼šä½¿ç”¨ Webpack ç¯å¢ƒå˜é‡
const baseURL = process.env.VUE_APP_BASE_API
```

---

## ğŸ—„ï¸ æ•°æ®åº“è§„èŒƒ

### 1. æ•°æ®åº“æ›´æ–°è§„èŒƒ

**é‡è¦**ï¼šæ•°æ®åº“è¡¨ç»“æ„çš„æ›´æ–°å¿…é¡»éµå¾ªä»¥ä¸‹è§„èŒƒï¼š

- âœ… æ–°å»ºSQLæ›´æ–°æ–‡ä»¶ï¼š`sql/updates/update_YYYYMMDD_åŠŸèƒ½æè¿°.sql`
- âœ… ä¸è¦ç›´æ¥ä¿®æ”¹åŸå§‹æ•°æ®åº“æ–‡ä»¶ `sql/wxfbsir.sql`
- âœ… åœ¨PRä¸­è¯´æ˜æ•°æ®åº“å˜æ›´å†…å®¹
- âœ… ç”±ç®¡ç†å‘˜å®¡æŸ¥å¹¶åœ¨åˆå¹¶åæ‰§è¡ŒSQLæ›´æ–°

**ç¤ºä¾‹**ï¼š
```sql
-- sql/updates/update_20251205_daily_article.sql
-- ============================================
-- æ•°æ®åº“æ›´æ–°è„šæœ¬
-- åŠŸèƒ½ï¼šæ·»åŠ æ—¥æ›´åŠ©æ‰‹æ–‡ç« è¡¨
-- æ—¥æœŸï¼š2025-12-05
-- ============================================

CREATE TABLE IF NOT EXISTS `daily_article` (
  `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'æ–‡ç« ID',
  `article_title` VARCHAR(500) NOT NULL COMMENT 'æ–‡ç« æ ‡é¢˜',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='æ—¥æ›´åŠ©æ‰‹æ–‡ç« è¡¨';
```

è¯¦ç»†è§„èŒƒè¯·æŸ¥çœ‹ [ä»£ç åˆå¹¶PRè§„èŒƒ.md](%E4%BB%A3%E7%A0%81%E5%90%88%E5%B9%B6PR%E8%A7%84%E8%8C%83.md)

### 2. è¡¨å‘½åè§„èŒƒ

```sql
-- âœ… æ­£ç¡®ï¼šå°å†™ï¼Œä¸‹åˆ’çº¿åˆ†éš”
CREATE TABLE daily_article ( ... );
CREATE TABLE yuanqi_agent_config ( ... );

-- âŒ é”™è¯¯ï¼šå¤§å†™æˆ–é©¼å³°
CREATE TABLE DailyArticle ( ... );
CREATE TABLE yuanqiAgentConfig ( ... );
```

### 2. å­—æ®µå‘½å

```sql
-- âœ… æ­£ç¡®ï¼šå°å†™ï¼Œä¸‹åˆ’çº¿åˆ†éš”ï¼Œè§åçŸ¥æ„
article_id BIGINT NOT NULL COMMENT 'æ–‡ç« ID',
article_title VARCHAR(500) NOT NULL COMMENT 'æ–‡ç« æ ‡é¢˜',
create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',

-- âŒ é”™è¯¯ï¼šç¼©å†™æˆ–æ— æ„ä¹‰å‘½å
aid BIGINT,
title VARCHAR(500),
ct DATETIME,
```

### 3. ç´¢å¼•å‘½å

```sql
-- âœ… æ­£ç¡®ï¼šidx_è¡¨å_å­—æ®µå
KEY idx_user_id (user_id),
KEY idx_create_time (create_time),
KEY idx_process_status (process_status),

-- âŒ é”™è¯¯ï¼šæ— æ„ä¹‰å‘½å
KEY index1 (user_id),
KEY i1 (create_time),
```

### 4. å¿…å¤‡å­—æ®µ

```sql
-- æ¯ä¸ªä¸šåŠ¡è¡¨å¿…é¡»åŒ…å«ä»¥ä¸‹å­—æ®µ
CREATE TABLE your_table (
  id BIGINT NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  -- ä¸šåŠ¡å­—æ®µ...
  create_by VARCHAR(64) DEFAULT NULL COMMENT 'åˆ›å»ºè€…',
  create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  update_by VARCHAR(64) DEFAULT NULL COMMENT 'æ›´æ–°è€…',
  update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  remark VARCHAR(500) DEFAULT NULL COMMENT 'å¤‡æ³¨',
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='è¡¨æ³¨é‡Š';
```

### 5. å­—æ®µç±»å‹é€‰æ‹©

```sql
-- âœ… æ­£ç¡®ï¼šæ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚ç±»å‹
user_id BIGINT NOT NULL,                    -- ID ä½¿ç”¨ BIGINT
article_title VARCHAR(500) NOT NULL,        -- çŸ­æ–‡æœ¬ä½¿ç”¨ VARCHAR
optimized_content LONGTEXT,                 -- é•¿æ–‡æœ¬ä½¿ç”¨ LONGTEXT
process_status TINYINT(1) DEFAULT 0,        -- çŠ¶æ€ä½¿ç”¨ TINYINT
publish_count INT DEFAULT 0,                -- è®¡æ•°ä½¿ç”¨ INT
create_time DATETIME DEFAULT CURRENT_TIMESTAMP,  -- æ—¶é—´ä½¿ç”¨ DATETIME

-- âŒ é”™è¯¯ï¼šç±»å‹é€‰æ‹©ä¸å½“
user_id INT,                                -- ID å¤ªå°
article_title TEXT,                         -- çŸ­æ–‡æœ¬ä½¿ç”¨ TEXT æµªè´¹ç©ºé—´
process_status VARCHAR(10),                 -- çŠ¶æ€ä½¿ç”¨å­—ç¬¦ä¸²
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [é˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œ](https://github.com/alibaba/p3c)
- [Vue é£æ ¼æŒ‡å—](https://cn.vuejs.org/style-guide/)
- [è‹¥ä¾æ¡†æ¶æ–‡æ¡£](http://doc.ruoyi.vip/)

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- **[ä»£ç åˆå¹¶PRè§„èŒƒ](./ä»£ç åˆå¹¶PRè§„èŒƒ.md)** - ä»£ç æäº¤å’ŒPRæµç¨‹è§„èŒƒ
- **[æ–‡æ¡£è§„èŒƒæ€»ç»“](./æ–‡æ¡£è§„èŒƒæ€»ç»“.md)** - é¡¹ç›®æ–‡æ¡£ç¼–å†™è§„èŒƒ
- **[FAQ](./FAQ.md)** - å¸¸è§é—®é¢˜è§£ç­”

---

**æœ€åæ›´æ–°**: 2025-12-05  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
