# ğŸ“ ä»£ç è§„èŒƒ

æœ¬æ–‡æ¡£å®šä¹‰äº†å¾®ä¿¡ç¦å¸®æ‰‹é¡¹ç›®çš„ä»£ç è§„èŒƒï¼ŒåŸºäºè‹¥ä¾æ¡†æ¶çš„æœ€ä½³å®è·µã€‚

---

## ğŸ“‹ ç›®å½•
- [Java åç«¯è§„èŒƒ](#-java-åç«¯è§„èŒƒ)
  - [1. å‘½åè§„èŒƒ](#1-å‘½åè§„èŒƒ)
  - [2. æ³¨é‡Šè§„èŒƒ](#2-æ³¨é‡Šè§„èŒƒ)
  - [3. ä»£ç ç»“æ„ä¸æ¨¡å—åˆ’åˆ†](#3-ä»£ç ç»“æ„ä¸æ¨¡å—åˆ’åˆ†)
  - [4. å¼‚å¸¸å¤„ç†](#4-å¼‚å¸¸å¤„ç†)
  - [5. æ—¥å¿—å¤„ç†è§„èŒƒ](#5-æ—¥å¿—å¤„ç†è§„èŒƒ)
  - [6. äº‹åŠ¡ç®¡ç†](#6-äº‹åŠ¡ç®¡ç†)
  - [7. æ•°æ®åŠ å¯†è§„èŒƒ](#7-æ•°æ®åŠ å¯†è§„èŒƒ)
- [Vue å‰ç«¯è§„èŒƒ](#-vue-å‰ç«¯è§„èŒƒ)
  - [1. ç»„ä»¶å‘½å](#1-ç»„ä»¶å‘½å)
  - [2. å˜é‡å‘½å](#2-å˜é‡å‘½å)
  - [3. Props å®šä¹‰](#3-props-å®šä¹‰)
  - [4. äº‹ä»¶å‘½å](#4-äº‹ä»¶å‘½å)
  - [5. ç»„ä»¶ç»“æ„](#5-ç»„ä»¶ç»“æ„)
  - [6. API è°ƒç”¨](#6-api-è°ƒç”¨)
  - [7. ç¯å¢ƒå˜é‡](#7-ç¯å¢ƒå˜é‡)
- [æ•°æ®åº“è§„èŒƒ](#-æ•°æ®åº“è§„èŒƒ)
  - [1. æ•°æ®åº“æ›´æ–°è§„èŒƒ](#1-æ•°æ®åº“æ›´æ–°è§„èŒƒ)
  - [2. è¡¨å‘½åè§„èŒƒ](#2-è¡¨å‘½åè§„èŒƒ)
  - [3. å­—æ®µå‘½å](#3-å­—æ®µå‘½å)
  - [4. ç´¢å¼•å‘½å](#4-ç´¢å¼•å‘½å)
  - [5. å¿…å¤‡å­—æ®µ](#5-å¿…å¤‡å­—æ®µ)
  - [6. å­—æ®µç±»å‹é€‰æ‹©](#6-å­—æ®µç±»å‹é€‰æ‹©)
- [æƒé™æ§åˆ¶è§„èŒƒ](#-æƒé™æ§åˆ¶è§„èŒƒ)

---

## â˜• Java åç«¯è§„èŒƒ

### 1. å‘½åè§„èŒƒ

#### ç±»å
```java
// âœ… æ­£ç¡®ï¼šå¤§é©¼å³°ï¼ˆPascalCaseï¼‰
public class DailyArticleController { }
public class YuanqiAgentApiService { }
```

#### æ–¹æ³•åå’Œå˜é‡å
```java
// âœ… æ­£ç¡®ï¼šå°é©¼å³°ï¼ˆcamelCaseï¼‰
private String articleTitle;
public void createArticle() { }
```

#### å¸¸é‡å
```java
// âœ… æ­£ç¡®ï¼šå…¨å¤§å†™ï¼Œä¸‹åˆ’çº¿åˆ†éš”
public static final String API_URL = "https://api.example.com";
public static final int MAX_RETRY_COUNT = 3;
```

### 2. æ³¨é‡Šè§„èŒƒ

**é‡è¦**ï¼šæ‰€æœ‰ä¸šåŠ¡ä»£ç å¿…é¡»åŒ…å«å¿…è¦çš„æ³¨é‡Šï¼Œè¯´æ˜ä¸šåŠ¡é€»è¾‘å’Œå…³é”®å¤„ç†æµç¨‹ã€‚

#### ç±»æ³¨é‡Šï¼ˆå¿…éœ€ï¼‰
```java
/**
 * æ—¥æ›´åŠ©æ‰‹æ–‡ç« æ§åˆ¶å™¨
 * 
 * æä¾›æ–‡ç« çš„åˆ›å»ºã€æŸ¥è¯¢ã€åˆ é™¤ç­‰åŠŸèƒ½
 * æ”¯æŒAIä¼˜åŒ–å’Œæ™ºèƒ½æ’ç‰ˆ
 *
 * @author wxfbsir
 * @date 2025-12-05
 */
@RestController
@RequestMapping("/system/daily-article")
public class DailyArticleController extends BaseController {
    // ...
}
```

#### æ–¹æ³•æ³¨é‡Šï¼ˆå¿…éœ€ï¼‰
```java
/**
 * åˆ›å»ºæ–‡ç« å¹¶è°ƒç”¨AIä¼˜åŒ–
 * 
 * æ­¤æ–¹æ³•ä¼šå¼‚æ­¥è°ƒç”¨è…¾è®¯å…ƒå™¨æ™ºèƒ½ä½“ï¼Œä¸ç­‰å¾…å†…å®¹ç”Ÿæˆå®Œæˆã€‚
 * å‰ç«¯éœ€è¦é€šè¿‡è½®è¯¢æ¥å£æŸ¥è¯¢å¤„ç†çŠ¶æ€ã€‚
 *
 * @param params è¯·æ±‚å‚æ•°ï¼ŒåŒ…å« articleTitle å’Œ selectedModels
 * @return æ–‡ç« åŸºæœ¬ä¿¡æ¯å’Œå¤„ç†çŠ¶æ€
 */
@PostMapping("/createAndOptimize")
public AjaxResult createAndOptimize(@RequestBody Map<String, String> params) {
    // ...
}
```

#### å¤æ‚é€»è¾‘æ³¨é‡Šï¼ˆå¿…éœ€ï¼‰
```java
// ç‰¹æ®Šå¤„ç†504 Gateway Timeoutï¼šä»»åŠ¡å¯èƒ½å·²æäº¤æˆåŠŸï¼Œåªæ˜¯ç½‘å…³ç­‰ä¸åŠè¿”å›ç»“æœ
if (errorMsg != null && errorMsg.contains("504 Gateway Time-out")) {
    log.warn("æ”¶åˆ°504 Gateway Timeoutï¼Œä»»åŠ¡å¯èƒ½å·²æäº¤æˆåŠŸ");
    // è¿”å›æˆåŠŸçŠ¶æ€ï¼Œè®©ç³»ç»Ÿç­‰å¾…å›è°ƒ
    return YuanqiApiResponse.success("", "pending-" + articleId);
}
```

### 3. ä»£ç ç»“æ„ä¸æ¨¡å—åˆ’åˆ†

**é‡è¦è§„èŒƒ**ï¼š
- âœ… ä¸šåŠ¡é€»è¾‘ä»£ç é»˜è®¤æ”¾åœ¨ `WxFbsir-business` æ¨¡å—ä¸‹
- âœ… å‰ç«¯ä¸šåŠ¡é¡µé¢é»˜è®¤æ”¾åœ¨ `WxFbsir-ui/src/views/business` ç›®å½•ä¸‹
- âš ï¸ å¦‚éœ€åœ¨å…¶ä»–ä½ç½®å­˜æ”¾ä¸šåŠ¡ä»£ç ï¼Œå¿…é¡»å…ˆä¸ç®¡ç†å‘˜æ¢è®¨ç¡®è®¤åæ‰å¯ä»¥

#### Controller å±‚ï¼ˆæ”¾åœ¨ WxFbsir-business æ¨¡å—ï¼‰
```java
@RestController
@RequestMapping("/system/daily-article")
public class DailyArticleController extends BaseController {
    
    @Autowired
    private IDailyArticleService dailyArticleService;
    
    /**
     * æŸ¥è¯¢åˆ—è¡¨
     */
    @GetMapping("/list")
    public TableDataInfo list(DailyArticle dailyArticle) {
        startPage();
        List<DailyArticle> list = dailyArticleService.selectDailyArticleList(dailyArticle);
        return getDataTable(list);
    }
    
    /**
     * æ–°å¢
     */
    @PostMapping
    public AjaxResult add(@Validated @RequestBody DailyArticle dailyArticle) {
        return toAjax(dailyArticleService.insertDailyArticle(dailyArticle));
    }
}
```

#### Service å±‚ï¼ˆæ”¾åœ¨ WxFbsir-business æ¨¡å—ï¼‰
```java
@Service
public class DailyArticleServiceImpl implements IDailyArticleService {
    
    @Autowired
    private DailyArticleMapper dailyArticleMapper;
    
    @Override
    public List<DailyArticle> selectDailyArticleList(DailyArticle dailyArticle) {
        return dailyArticleMapper.selectDailyArticleList(dailyArticle);
    }
    
    @Override
    @Transactional(rollbackFor = Exception.class)
    public int insertDailyArticle(DailyArticle dailyArticle) {
        dailyArticle.setCreateTime(DateUtils.getNowDate());
        return dailyArticleMapper.insertDailyArticle(dailyArticle);
    }
}
```

### 4. å¼‚å¸¸å¤„ç†

```java
// âœ… æ­£ç¡®ï¼šæ•è·å…·ä½“å¼‚å¸¸ï¼Œè®°å½•æ—¥å¿—
try {
    dailyArticleService.createArticle(articleTitle);
} catch (IllegalArgumentException e) {
    log.error("å‚æ•°é”™è¯¯: {}", e.getMessage());
    return error("å‚æ•°é”™è¯¯: " + e.getMessage());
} catch (Exception e) {
    log.error("åˆ›å»ºæ–‡ç« å¤±è´¥", e);
    return error("åˆ›å»ºå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");
}

// âŒ é”™è¯¯ï¼šæ•è·æ‰€æœ‰å¼‚å¸¸ï¼Œä¸è®°å½•æ—¥å¿—
try {
    dailyArticleService.createArticle(articleTitle);
} catch (Exception e) {
    return error("å¤±è´¥");
}
```

### 5. æ—¥å¿—å¤„ç†è§„èŒƒ

#### 5.1 æ—¥å¿—çº§åˆ«ä½¿ç”¨

**æ—¥å¿—çº§åˆ«å®šä¹‰ï¼š**

| çº§åˆ« | ç”¨é€” | ä½¿ç”¨åœºæ™¯ | ç”Ÿäº§ç¯å¢ƒ |
|---|---|---|---|
| **ERROR** | ä¸šåŠ¡å¼‚å¸¸ã€ç³»ç»Ÿé”™è¯¯ | å¾®ä¿¡APIè°ƒç”¨å¤±è´¥ã€æ•°æ®åº“æ“ä½œå¤±è´¥ã€åŠ å¯†è§£å¯†å¤±è´¥ | âœ… è¾“å‡º |
| **WARN** | å¯æ¢å¤çš„å¼‚å¸¸çŠ¶æ€ | å‚æ•°æ ¡éªŒå¤±è´¥ã€èµ„æºä¸å­˜åœ¨ã€é…ç½®ç¼ºå¤± | âœ… è¾“å‡º |
| **INFO** | å…³é”®ä¸šåŠ¡èŠ‚ç‚¹ | æ–‡ç« åˆ›å»ºæˆåŠŸã€ä»»åŠ¡æäº¤æˆåŠŸã€é‡è¦çŠ¶æ€å˜æ›´ | âœ… è¾“å‡º |
| **DEBUG** | è¯¦ç»†è°ƒè¯•ä¿¡æ¯ | HTTPè¯·æ±‚è¯¦æƒ…ã€å‚æ•°å€¼ã€ä¸­é—´å¤„ç†ç»“æœ | âŒ ä¸è¾“å‡º |
| **TRACE** | å®Œæ•´æ•°æ®dump | è¯·æ±‚ä½“å®Œæ•´å†…å®¹ã€å“åº”ä½“å®Œæ•´å†…å®¹ | âŒ ä¸è¾“å‡º |

**å¼€å‘ç¯å¢ƒé…ç½®ï¼š**
```yaml
# application.yml - å¼€å‘ç¯å¢ƒ
logging:
  level:
    com.wx.fbsir: DEBUG              # ä¸šåŠ¡ä»£ç ä½¿ç”¨DEBUGï¼Œæ–¹ä¾¿è°ƒè¯•
    com.wx.fbsir.common.utils: DEBUG # å·¥å…·ç±»ä½¿ç”¨DEBUG
    org.springframework: INFO         # Springæ¡†æ¶INFO
```

**ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼š**
```yaml
# application.yml - ç”Ÿäº§ç¯å¢ƒ
logging:
  level:
    com.wx.fbsir: INFO               # ä¸šåŠ¡ä»£ç ä½¿ç”¨INFOï¼Œå‡å°‘æ—¥å¿—é‡
    com.wx.fbsir.common.utils: WARN  # å·¥å…·ç±»åªè®°å½•è­¦å‘Šå’Œé”™è¯¯
    org.springframework: WARN        # Springæ¡†æ¶åªè®°å½•è­¦å‘Š
    org.apache: ERROR                # Apacheç»„ä»¶åªè®°å½•é”™è¯¯
```

#### 5.2 æ—¥å¿—æ ¼å¼è§„èŒƒ

```java
// âœ… æ­£ç¡®ï¼šä½¿ç”¨å ä½ç¬¦ï¼Œæ·»åŠ ä¸šåŠ¡æ ‡ç­¾ï¼Œç®€æ´æ˜äº†
log.info("[è‰ç¨¿ç®±] æ·»åŠ æˆåŠŸ - æ ‡é¢˜: {}, MediaID: {}", title, mediaId);
log.error("[å¾®ä¿¡API] è·å–access_tokenå¤±è´¥ - é”™è¯¯ç : {}, é”™è¯¯ä¿¡æ¯: {}", errcode, errmsg);
log.debug("[æ’ç‰ˆ] å¼€å§‹å¤„ç† - å†…å®¹é•¿åº¦: {}", content.length());

// âŒ é”™è¯¯ï¼šå­—ç¬¦ä¸²æ‹¼æ¥ã€æ— ä¸šåŠ¡æ ‡ç­¾
log.info("åˆ›å»ºæ–‡ç« æˆåŠŸ - articleId: " + articleId + ", userId: " + userId);
log.error("è°ƒç”¨APIå¤±è´¥");
```

#### 5.3 å¼‚å¸¸æ—¥å¿—è§„èŒƒ

```java
// âœ… æ­£ç¡®ï¼šç®€æ´è¾“å‡ºå¼‚å¸¸ä¿¡æ¯ï¼Œä¸è¾“å‡ºå †æ ˆï¼ˆé™¤éæ˜¯ä¸¥é‡é”™è¯¯ï¼‰
try {
    String encrypted = AesEncryptUtils.encrypt(plainText);
} catch (Exception e) {
    log.error("[AESåŠ å¯†] åŠ å¯†å¤±è´¥ - é”™è¯¯ç±»å‹: {}, é”™è¯¯ä¿¡æ¯: {}", 
        e.getClass().getSimpleName(), e.getMessage());
    throw new Exception("AESåŠ å¯†å¤±è´¥: " + e.getMessage());
}

// âœ… æ­£ç¡®ï¼šåŒºåˆ†ä¸šåŠ¡å¼‚å¸¸å’Œç½‘ç»œå¼‚å¸¸
try {
    ResponseEntity<String> response = restTemplate.postForEntity(url, request, String.class);
} catch (Exception e) {
    if (e.getMessage().contains("å¾®ä¿¡APIè¿”å›é”™è¯¯")) {
        throw e; // ç›´æ¥æŠ›å‡ºä¸šåŠ¡å¼‚å¸¸ï¼Œé¿å…é‡å¤åŒ…è£…
    }
    log.error("[è‰ç¨¿ç®±] ç½‘ç»œè¯·æ±‚å¼‚å¸¸ - æ ‡é¢˜: {}, é”™è¯¯: {}", title, e.getMessage());
    throw new Exception("æ·»åŠ è‰ç¨¿ç½‘ç»œå¼‚å¸¸: " + e.getMessage());
}

// âŒ é”™è¯¯ï¼šè¾“å‡ºå®Œæ•´å †æ ˆï¼Œæ—¥å¿—å†—ä½™
try {
    // ...
} catch (Exception e) {
    log.error("æ“ä½œå¤±è´¥", e); // ä¼šè¾“å‡ºå®Œæ•´å †æ ˆ
    throw e;
}
```

#### 5.4 ç‰¹æ®Šåœºæ™¯æ—¥å¿—è§„èŒƒ

**åœºæ™¯1ï¼šå¾ªç¯é‡è¯•ï¼ˆåªè®°å½•æœ€ç»ˆç»“æœï¼‰**
```java
// âœ… æ­£ç¡®ï¼šå•æ¬¡å¤±è´¥ä¸è®°å½•ï¼Œå…¨éƒ¨å¤±è´¥æ‰è®°å½•
public static String getPublicIp() {
    for (String url : IP_CHECK_URLS) {
        try {
            String ip = getIpFromUrl(url);
            if (ip != null && !ip.isEmpty()) {
                log.debug("[IPè·å–] æˆåŠŸè·å–å…¬ç½‘IP: {} (æ¥æº: {})", ip, url);
                return ip.trim();
            }
        } catch (Exception e) {
            // å•ä¸ªæœåŠ¡å¤±è´¥ä¸è®°å½•ï¼Œç»§ç»­å°è¯•ä¸‹ä¸€ä¸ª
        }
    }
    log.error("[IPè·å–] æ‰€æœ‰å…¬ç½‘IPæŸ¥è¯¢æœåŠ¡å‡å¤±è´¥ï¼Œå·²å°è¯•: {}", String.join(", ", IP_CHECK_URLS));
    return null;
}
```

**åœºæ™¯2ï¼šé‡å¤æ“ä½œï¼ˆä½¿ç”¨DEBUGï¼‰**
```java
// âœ… æ­£ç¡®ï¼šé¢‘ç¹æ“ä½œä½¿ç”¨DEBUGï¼Œé¿å…INFOæ—¥å¿—åˆ·å±
log.debug("è·å–å¾®ä¿¡access_token - AppID: {}", appId);
log.debug("è·å–access_tokenæˆåŠŸ");

// âŒ é”™è¯¯ï¼šé¢‘ç¹æ“ä½œä½¿ç”¨INFOï¼Œç”Ÿäº§ç¯å¢ƒæ—¥å¿—é‡å¤§
log.info("è·å–å¾®ä¿¡access_tokenï¼Œurl: {}", url);
log.info("è·å–access_tokenæˆåŠŸ");
```

**åœºæ™¯3ï¼šæ•°æ®å¤„ç†è¿‡ç¨‹ï¼ˆä½¿ç”¨TRACEï¼‰**
```java
// âœ… æ­£ç¡®ï¼šå®Œæ•´æ•°æ®ä½¿ç”¨TRACE
log.debug("[å†…å®¹å¤„ç†] HTMLæ ¼å¼ï¼Œæ¸…ç†æ¢è¡Œç¬¦ - åŸå§‹: {} â†’ å¤„ç†å: {} å­—ç¬¦", 
    content.length(), htmlContent.length());
log.trace("[å†…å®¹å¤„ç†] æœ€ç»ˆcontent(å‰300å­—ç¬¦): {}", 
    htmlContent.length() > 300 ? htmlContent.substring(0, 300) : htmlContent);
```

#### 5.5 æ—¥å¿—è§„èŒƒæ€»ç»“

**å¿…é¡»éµå®ˆï¼š**
- âœ… æ‰€æœ‰å¼‚å¸¸å¿…é¡»è®°å½•æ—¥å¿—
- âœ… å…³é”®ä¸šåŠ¡èŠ‚ç‚¹ä½¿ç”¨INFO
- âœ… è¯¦ç»†è°ƒè¯•ä¿¡æ¯ä½¿ç”¨DEBUG
- âœ… å¼‚å¸¸æ—¥å¿—å¿…é¡»åŒ…å«ï¼šé”™è¯¯ç±»å‹ã€é”™è¯¯ä¿¡æ¯ã€ä¸šåŠ¡ä¸Šä¸‹æ–‡
- âœ… ä½¿ç”¨ä¸šåŠ¡æ ‡ç­¾ï¼š`[å¾®ä¿¡API]`ã€`[è‰ç¨¿ç®±]`ã€`[æ’ç‰ˆ]`ã€`[AESåŠ å¯†]`

**ç¦æ­¢è¡Œä¸ºï¼š**
- âŒ ç¦æ­¢å¿½ç•¥å¼‚å¸¸ä¸è®°å½•æ—¥å¿—
- âŒ ç¦æ­¢åœ¨INFOçº§åˆ«è¾“å‡ºå¤§é‡è°ƒè¯•æ—¥å¿—
- âŒ ç¦æ­¢æ— æ„ä¹‰çš„æ—¥å¿—ï¼ˆå¦‚ï¼š"è¿›å…¥æ–¹æ³•"ã€"é€€å‡ºæ–¹æ³•"ï¼‰
- âŒ ç¦æ­¢åœ¨æ—¥å¿—ä¸­è¾“å‡ºæ•æ„Ÿä¿¡æ¯ï¼ˆå¯†é’¥ã€å¯†ç ã€Tokenï¼‰

### 6. äº‹åŠ¡ç®¡ç†

```java
// âœ… æ­£ç¡®ï¼šæŒ‡å®šå›æ»šå¼‚å¸¸
@Transactional(rollbackFor = Exception.class)
public int updateArticle(DailyArticle article) {
    // æ›´æ–°æ–‡ç« 
    dailyArticleMapper.updateDailyArticle(article);
    // æ›´æ–°ç»Ÿè®¡
    statisticsMapper.updateCount(article.getUserId());
    return 1;
}

// âŒ é”™è¯¯ï¼šä¸æŒ‡å®šå›æ»šå¼‚å¸¸ï¼ˆé»˜è®¤åªå›æ»š RuntimeExceptionï¼‰
@Transactional
public int updateArticle(DailyArticle article) {
    // ...
}
```

### 7. æ•°æ®åŠ å¯†è§„èŒƒ

#### 7.1 å¿…é¡»åŠ å¯†çš„å­—æ®µ

æ‰€æœ‰æ•æ„Ÿä¿¡æ¯å¿…é¡»åŠ å¯†å­˜å‚¨ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š
- å¾®ä¿¡å…¬ä¼—å·AppIDã€AppSecret
- ç¬¬ä¸‰æ–¹APIå¯†é’¥
- ç”¨æˆ·éšç§æ•°æ®
- æ”¯ä»˜ç›¸å…³å‡­è¯

#### 7.2 åŠ å¯†å·¥å…·ä½¿ç”¨

**å·¥å…·ç±»è·¯å¾„ï¼š** `WxFbsir-common/src/main/java/com/wx/fbsir/common/utils/AesEncryptUtils.java`

**åŠ å¯†ç¤ºä¾‹ï¼š**
```java
import com.wx.fbsir.common.utils.AesEncryptUtils;

// ä¿å­˜æ—¶åŠ å¯†
String plainAppId = "wx1234567890abcdef";
String encryptedAppId = AesEncryptUtils.encrypt(plainAppId);
wcOfficeAccount.setAppId(encryptedAppId);
```

**è§£å¯†ç¤ºä¾‹ï¼š**
```java
// ä½¿ç”¨æ—¶è§£å¯†
String encryptedAppId = account.getAppId();
String plainAppId = AesEncryptUtils.decrypt(encryptedAppId);
```

**ç”Ÿæˆæ–°å¯†é’¥ï¼š**
```java
// ç”Ÿæˆéšæœºå¯†é’¥ï¼ˆç”¨äºåˆå§‹åŒ–æˆ–æ›´æ¢å¯†é’¥ï¼‰
String newKey = AesEncryptUtils.generateRandomKey();
System.out.println("æ–°å¯†é’¥: " + newKey);
```

#### 7.3 å¯†é’¥é…ç½®

åœ¨ `application.yml` ä¸­é…ç½®AESå¯†é’¥ï¼š
```yaml
aes:
  secret:
    key: ä½ çš„64ä½å¤æ‚å¯†é’¥
```

**å¯†é’¥è¦æ±‚ï¼š**
- é•¿åº¦ï¼šå»ºè®®64ä¸ªå­—ç¬¦
- åŒ…å«ï¼šå¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šç¬¦å·
- å¤æ‚åº¦ï¼šé«˜åº¦éšæœºï¼Œæ— è§„å¾‹

#### 7.4 å®‰å…¨å»ºè®®

**å¿…é¡»éµå®ˆï¼š**
- âœ… ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨å¯†é’¥
- âœ… å®šæœŸæ›´æ¢å¯†é’¥ï¼ˆå»ºè®®æ¯3-6ä¸ªæœˆï¼‰
- âœ… ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒå¯†é’¥
- âœ… å¯†é’¥ä¸è¦æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ

**ç¦æ­¢è¡Œä¸ºï¼š**
- âŒ ç¦æ­¢åœ¨æ—¥å¿—ä¸­è¾“å‡ºå¯†é’¥
- âŒ ç¦æ­¢åœ¨å‰ç«¯ä»£ç ä¸­æš´éœ²å¯†é’¥
- âŒ ç¦æ­¢ä½¿ç”¨ç®€å•æˆ–è§„å¾‹çš„å¯†é’¥ï¼ˆå¦‚ï¼š123456ã€passwordï¼‰
- âŒ ç¦æ­¢å°†å¯†é’¥ç¡¬ç¼–ç åœ¨ä»£ç ä¸­

---

## ğŸ¨ Vue å‰ç«¯è§„èŒƒ

### 1. ç»„ä»¶å‘½å

```vue
<!-- âœ… æ­£ç¡®ï¼šå¤§é©¼å³°ï¼Œå¤šä¸ªå•è¯ -->
<template>
  <DailyArticleList />
  <YuanqiConfigDialog />
</template>

<!-- âŒ é”™è¯¯ï¼šå•ä¸ªå•è¯æˆ–å°å†™ -->
<template>
  <article />
  <config-dialog />
</template>
```

### 2. å˜é‡å‘½å

```javascript
// âœ… æ­£ç¡®ï¼šå°é©¼å³°
const articleTitle = ref('')
const selectedModels = ref([])
const isLoading = ref(false)

// âŒ é”™è¯¯ï¼šä¸‹åˆ’çº¿æˆ–å¤§é©¼å³°
const article_title = ref('')
const ArticleTitle = ref('')
```

### 3. Props å®šä¹‰

```vue
<script setup>
// âœ… æ­£ç¡®ï¼šå®šä¹‰ç±»å‹ã€é»˜è®¤å€¼ã€å¿…å¡«é¡¹
const props = defineProps({
  articleId: {
    type: Number,
    required: true
  },
  title: {
    type: String,
    default: ''
  },
  status: {
    type: Number,
    default: 0,
    validator: (value) => [0, 1, 2].includes(value)
  }
})

// âŒ é”™è¯¯ï¼šä¸å®šä¹‰ç±»å‹
const props = defineProps(['articleId', 'title', 'status'])
</script>
```

### 4. äº‹ä»¶å‘½å

```vue
<template>
  <!-- âœ… æ­£ç¡®ï¼škebab-case -->
  <el-button @click="handleCreate">åˆ›å»º</el-button>
  <ArticleItem @article-selected="handleSelect" />
  
  <!-- âŒ é”™è¯¯ï¼šcamelCase -->
  <el-button @click="handleCreate">åˆ›å»º</el-button>
  <ArticleItem @articleSelected="handleSelect" />
</template>
```

### 5. ç»„ä»¶ç»“æ„

```vue
<template>
  <!-- æ¨¡æ¿å†…å®¹ -->
</template>

<script setup>
// 1. å¯¼å…¥
import { ref, onMounted } from 'vue'
import { ElMessage } from 'element-plus'
import { getArticleList } from '@/api/business/dailyArticle'

// 2. Props å’Œ Emits
const props = defineProps({ /* ... */ })
const emit = defineEmits(['update', 'delete'])

// 3. å“åº”å¼æ•°æ®
const articles = ref([])
const loading = ref(false)

// 4. è®¡ç®—å±æ€§
const filteredArticles = computed(() => {
  return articles.value.filter(item => item.status === 1)
})

// 5. æ–¹æ³•
function handleCreate() {
  // ...
}

// 6. ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  loadArticles()
})
</script>

<style scoped>
/* æ ·å¼ */
</style>
```

### 6. API è°ƒç”¨

```javascript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ async/awaitï¼Œå¤„ç†é”™è¯¯
async function loadArticles() {
  loading.value = true
  try {
    const response = await getArticleList()
    articles.value = response.rows
  } catch (error) {
    ElMessage.error('åŠ è½½å¤±è´¥ï¼š' + error.message)
  } finally {
    loading.value = false
  }
}

// âŒ é”™è¯¯ï¼šä¸å¤„ç†é”™è¯¯
function loadArticles() {
  getArticleList().then(response => {
    articles.value = response.rows
  })
}
```

### 7. ç¯å¢ƒå˜é‡

```javascript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ Vite ç¯å¢ƒå˜é‡
const baseURL = import.meta.env.VITE_APP_BASE_API
const isDev = import.meta.env.DEV

// âŒ é”™è¯¯ï¼šä½¿ç”¨ Webpack ç¯å¢ƒå˜é‡
const baseURL = process.env.VUE_APP_BASE_API
```

---

## ğŸ—„ï¸ æ•°æ®åº“è§„èŒƒ

### 1. æ•°æ®åº“æ›´æ–°è§„èŒƒ

**é‡è¦**ï¼šæ•°æ®åº“è¡¨ç»“æ„çš„æ›´æ–°å¿…é¡»éµå¾ªä»¥ä¸‹è§„èŒƒï¼š

- âœ… æ–°å»ºSQLæ›´æ–°æ–‡ä»¶ï¼š`sql/updates/update_YYYYMMDD_åŠŸèƒ½æè¿°.sql`
- âœ… ä¸è¦ç›´æ¥ä¿®æ”¹åŸå§‹æ•°æ®åº“æ–‡ä»¶ `sql/wxfbsir.sql`
- âœ… åœ¨PRä¸­è¯´æ˜æ•°æ®åº“å˜æ›´å†…å®¹
- âœ… ç”±ç®¡ç†å‘˜å®¡æŸ¥å¹¶åœ¨åˆå¹¶åæ‰§è¡ŒSQLæ›´æ–°

**ç¤ºä¾‹**ï¼š
```sql
-- sql/updates/update_20251205_daily_article.sql
-- ============================================
-- æ•°æ®åº“æ›´æ–°è„šæœ¬
-- åŠŸèƒ½ï¼šæ·»åŠ æ—¥æ›´åŠ©æ‰‹æ–‡ç« è¡¨
-- æ—¥æœŸï¼š2025-12-05
-- ============================================

CREATE TABLE IF NOT EXISTS `daily_article` (
  `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'æ–‡ç« ID',
  `article_title` VARCHAR(500) NOT NULL COMMENT 'æ–‡ç« æ ‡é¢˜',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='æ—¥æ›´åŠ©æ‰‹æ–‡ç« è¡¨';
```

è¯¦ç»†è§„èŒƒè¯·æŸ¥çœ‹ [ä»£ç åˆå¹¶PRè§„èŒƒ.md](%E4%BB%A3%E7%A0%81%E5%90%88%E5%B9%B6PR%E8%A7%84%E8%8C%83.md)

### 2. è¡¨å‘½åè§„èŒƒ

```sql
-- âœ… æ­£ç¡®ï¼šå°å†™ï¼Œä¸‹åˆ’çº¿åˆ†éš”
CREATE TABLE daily_article ( ... );
CREATE TABLE yuanqi_agent_config ( ... );

-- âŒ é”™è¯¯ï¼šå¤§å†™æˆ–é©¼å³°
CREATE TABLE DailyArticle ( ... );
CREATE TABLE yuanqiAgentConfig ( ... );
```

### 3. å­—æ®µå‘½å

```sql
-- âœ… æ­£ç¡®ï¼šå°å†™ï¼Œä¸‹åˆ’çº¿åˆ†éš”ï¼Œè§åçŸ¥æ„
article_id BIGINT NOT NULL COMMENT 'æ–‡ç« ID',
article_title VARCHAR(500) NOT NULL COMMENT 'æ–‡ç« æ ‡é¢˜',
create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',

-- âŒ é”™è¯¯ï¼šç¼©å†™æˆ–æ— æ„ä¹‰å‘½å
aid BIGINT,
title VARCHAR(500),
ct DATETIME,
```

### 4. ç´¢å¼•å‘½å

```sql
-- âœ… æ­£ç¡®ï¼šidx_è¡¨å_å­—æ®µå
KEY idx_user_id (user_id),
KEY idx_create_time (create_time),
KEY idx_process_status (process_status),

-- âŒ é”™è¯¯ï¼šæ— æ„ä¹‰å‘½å
KEY index1 (user_id),
KEY i1 (create_time),
```

### 5. å¿…å¤‡å­—æ®µ

```sql
-- æ¯ä¸ªä¸šåŠ¡è¡¨å¿…é¡»åŒ…å«ä»¥ä¸‹å­—æ®µ
CREATE TABLE your_table (
  id BIGINT NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  -- ä¸šåŠ¡å­—æ®µ...
  create_by VARCHAR(64) DEFAULT NULL COMMENT 'åˆ›å»ºè€…',
  create_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  update_by VARCHAR(64) DEFAULT NULL COMMENT 'æ›´æ–°è€…',
  update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  remark VARCHAR(500) DEFAULT NULL COMMENT 'å¤‡æ³¨',
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='è¡¨æ³¨é‡Š';
```

### 6. å­—æ®µç±»å‹é€‰æ‹©

```sql
-- âœ… æ­£ç¡®ï¼šæ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚ç±»å‹
user_id BIGINT NOT NULL,                    -- ID ä½¿ç”¨ BIGINT
article_title VARCHAR(500) NOT NULL,        -- çŸ­æ–‡æœ¬ä½¿ç”¨ VARCHAR
optimized_content LONGTEXT,                 -- é•¿æ–‡æœ¬ä½¿ç”¨ LONGTEXT
process_status TINYINT(1) DEFAULT 0,        -- çŠ¶æ€ä½¿ç”¨ TINYINT
publish_count INT DEFAULT 0,                -- è®¡æ•°ä½¿ç”¨ INT
create_time DATETIME DEFAULT CURRENT_TIMESTAMP,  -- æ—¶é—´ä½¿ç”¨ DATETIME

-- âŒ é”™è¯¯ï¼šç±»å‹é€‰æ‹©ä¸å½“
user_id INT,                                -- ID å¤ªå°
article_title TEXT,                         -- çŸ­æ–‡æœ¬ä½¿ç”¨ TEXT æµªè´¹ç©ºé—´
process_status VARCHAR(10),                 -- çŠ¶æ€ä½¿ç”¨å­—ç¬¦ä¸²
```

---

## ğŸ” æƒé™æ§åˆ¶è§„èŒƒ

**âš ï¸ é‡è¦ï¼šæ‰€æœ‰é¡µé¢åŠŸèƒ½å¿…é¡»ä½¿ç”¨è‹¥ä¾çš„æƒé™æ§åˆ¶ï¼Œç‰¹åˆ«æ˜¯æŒ‰é’®çº§æƒé™æ§åˆ¶ã€‚**

### æ ¸å¿ƒè¦æ±‚

1. **å‰ç«¯æƒé™æ§åˆ¶**
   - âœ… æ‰€æœ‰æŒ‰é’®å¿…é¡»ä½¿ç”¨ `v-hasPermi` æŒ‡ä»¤
   - âœ… èœå•æƒé™é€šè¿‡è·¯ç”±é…ç½®çš„ `perms` å­—æ®µæ§åˆ¶
   - âœ… é¡µé¢ç»„ä»¶æ”¾åœ¨ `WxFbsir-ui/src/views/business/` ç›®å½•ä¸‹
   - âœ… API æ–‡ä»¶æ”¾åœ¨ `WxFbsir-ui/src/api/business/` ç›®å½•ä¸‹

2. **åç«¯æƒé™æ§åˆ¶**
   - âœ… æ‰€æœ‰ Controller æ¥å£å¿…é¡»æ·»åŠ  `@PreAuthorize` æ³¨è§£
   - âœ… ä¸šåŠ¡ä»£ç æ”¾åœ¨ `WxFbsir-business/src/main/java/com/wx/fbsir/business/` åŒ…ä¸‹
   - âœ… æ•°æ®æŸ¥è¯¢å¿…é¡»è¿‡æ»¤ userIdï¼Œç¡®ä¿æ•°æ®éš”ç¦»
   - âœ… åˆ é™¤/ä¿®æ”¹æ“ä½œå¿…é¡»éªŒè¯æ•°æ®æ‰€æœ‰æƒ

3. **æ•°æ®åº“æƒé™é…ç½®**
   - âœ… èœå•IDè§„åˆ’ï¼šä¸€çº§(1-99)ã€äºŒçº§(100-499)ã€ä¸‰çº§(500-999)ã€æŒ‰é’®(1000+)
   - âœ… ä¸šåŠ¡äºŒçº§èœå•ä» 117 å¼€å§‹
   - âœ… ä¸šåŠ¡æŒ‰é’®æƒé™ä» 1061 å¼€å§‹
   - âœ… æƒé™æ ‡è¯†æ ¼å¼ï¼š`æ¨¡å—:åŠŸèƒ½:æ“ä½œ`ï¼ˆå¦‚ï¼š`business:daily:add`ï¼‰

### ç¤ºä¾‹ä»£ç 

**å‰ç«¯æŒ‰é’®æƒé™ï¼š**
```vue
<el-button
  type="primary"
  icon="Plus"
  @click="handleAdd"
  v-hasPermi="['business:daily:add']"
>
  æ–°å¢æ–‡ç« 
</el-button>
```

**åç«¯æ¥å£æƒé™ï¼š**
```java
@PreAuthorize("@ss.hasPermi('business:daily:add')")
@PostMapping
public AjaxResult add(@RequestBody DailyArticle dailyArticle) {
    dailyArticle.setUserId(getUserId());
    return toAjax(dailyArticleService.insertDailyArticle(dailyArticle));
}
```

**æ•°æ®åº“èœå•é…ç½®ï¼š**
```sql
-- äºŒçº§èœå•
insert into sys_menu values('117', 'æ—¥æ›´åŠ©æ‰‹', '1', '1', 'daily-assistant', 
    'business/content/dailyassistant/index', '', '', 1, 0, 'C', '0', '0', 
    'business:daily:view', 'edit', 'admin', sysdate(), '', null, 'æ—¥æ›´åŠ©æ‰‹èœå•');

-- æŒ‰é’®æƒé™
insert into sys_menu values('1061', 'æ–‡ç« æŸ¥è¯¢', '117', '1', '#', '', '', '', 
    1, 0, 'F', '0', '0', 'business:daily:query', '#', 'admin', sysdate(), '', null, '');
```

### è¯¦ç»†æ–‡æ¡£

å®Œæ•´çš„æƒé™æ§åˆ¶è§„èŒƒè¯·æŸ¥çœ‹ï¼š**[æƒé™æ§åˆ¶è§„èŒƒ.md](./æƒé™æ§åˆ¶è§„èŒƒ.md)**

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [é˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œ](https://github.com/alibaba/p3c)
- [Vue é£æ ¼æŒ‡å—](https://cn.vuejs.org/style-guide/)
- [è‹¥ä¾æ¡†æ¶æ–‡æ¡£](http://doc.ruoyi.vip/)
- [è‹¥ä¾æƒé™æ§åˆ¶](http://doc.ruoyi.vip/ruoyi-vue/document/spjc.html#æƒé™æ§åˆ¶)

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- **[æƒé™æ§åˆ¶è§„èŒƒ](./æƒé™æ§åˆ¶è§„èŒƒ.md)** - æƒé™ä½“ç³»è¯¦ç»†è¯´æ˜ï¼ˆå¿…è¯»ï¼‰
- **[ä»£ç åˆå¹¶PRè§„èŒƒ](./ä»£ç åˆå¹¶PRè§„èŒƒ.md)** - ä»£ç æäº¤å’ŒPRæµç¨‹è§„èŒƒ
- **[æ–‡æ¡£è§„èŒƒæ€»ç»“](./æ–‡æ¡£è§„èŒƒæ€»ç»“.md)** - é¡¹ç›®æ–‡æ¡£ç¼–å†™è§„èŒƒ
- **[FAQ](./FAQ.md)** - å¸¸è§é—®é¢˜è§£ç­”

---

**æœ€åæ›´æ–°**: 2025-12-09
